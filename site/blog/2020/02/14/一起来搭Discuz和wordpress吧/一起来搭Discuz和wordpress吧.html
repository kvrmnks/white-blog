<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"> <meta name="viewport" content="width=device-width">
    <title>一起来搭Discuz和wordpress吧</title>
    <meta name="viewport" content="width=device-width,initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/androidstudio.min.css">
    <link rel="stylesheet"
          href="./../../../../../global.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Kvrmnks' blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item active">
              <a class="nav-link" href="./../../../../../index.html" target="_self">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./../../../../../blog.html">Blog</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./../../../../../about.html">About</a>
            </li>
          </ul>
        </div>
      </nav>



    <div class='container'>
      <p>颓废了一个寒假,临末尾来搭一个Discuz+wordpress吧
<!--more--></p>

<h3>环境</h3>

<p>系统 centos 7 </p>

<p>虚拟机 Vmware</p>

<p>Discuz X3.4</p>

<p>数据库 </p>

<h3>一些linux指令简单介绍</h3>

<h4>reboot</h4>

<p>重启</p>

<h4>ll</h4>

<p>显示当前目录文件和文件夹</p>

<p>相当于windows下的dir</p>

<h4>cd</h4>

<p>后面加文件夹名可以跳转到相应的文件夹中</p>

<p>和windows上的cd一样</p>

<p>另外</p>

<pre><code>cd ~
</code></pre>

<p>是跳转到一开始的目录</p>

<pre><code>cd ..
</code></pre>

<p>是跳转到上一层</p>

<h4>vi</h4>

<p>vi是linux中自带的记事本,不过相比较windows强了不知道多少倍...</p>

<p>它的GUI版本是熟悉的vim哦~</p>

<p>后面加文件名就可以打开或者创建文件</p>

<p>打开之后,要点一下i键才可以正常的编辑,如果和我版本一样的额话,可以在屏幕左下角看到一个INSERT</p>

<p>如果要保存或者退出,需要先点一下Esc键,这时候左下角的INSERT就会消失</p>

<p>输入
<code>:wq</code>
就代表保存并退出</p>

<p>这个时候你输入的指令都会显示在屏幕的最下面</p>

<p>输入
<code>:q</code>
代表退出</p>

<h4>cp</h4>

<p>cp指令就是复制啦
它的用法是
<code>cp -参数 你要复制的 你要复制到哪里</code>
现在只用到了一个参数</p>

<p>-r代表递归复制,简单来说就是复制文件夹</p>

<h3>windows下使用ssh</h3>

<p>右键点击屏幕左下角的windows标志</p>

<p><img src="1587643078100.png" alt=""></p>

<p>选择Windows PowerShell</p>

<p>输入</p>

<pre><code>ssh 用户名@ip地址
</code></pre>

<p>如果出现让你输yes/no就输yes</p>

<p>然后会让你输入密码</p>

<p>连接完之后你在PowerShell里输入什么,连接的电脑就会做什么了~</p>

<h3>安装Vmware</h3>

<p>这有啥好说的???</p>

<p>跳过</p>

<h3>安装centos系统</h3>

<p><del>这有啥好说的</del></p>

<p>一定要记好自己的密码,用户名默认是root</p>

<p>每次登录的时候都需要输入账号和密码</p>

<p><img src="1587643152551.png" alt="">
这里主要讲一下配置网络的细节吧</p>

<p>因为可以联网之后,就可以用ssh控制电脑了呢,就不用盯着虚拟机那个小框了呢~</p>

<p>先输入以下</p>

<pre><code>ip addr
</code></pre>

<p>如果长成这样</p>

<p><img src="1587643165015.png" alt="">
注意看红线下面没有出现ip地址,这个时候就要手动配置一下网络</p>

<p>打开虚拟机设置</p>

<p><img src="1587643177915.png" alt="">
调整成桥接模式</p>

<p><img src="1587643185764.png" alt="">
然后回到虚拟机,输入</p>

<pre><code>cd /etc/sysconfig/network-scripts
</code></pre>

<p>再输入
<code>ll</code></p>

<p><img src="1587643195291.png" alt="">
输入</p>

<pre><code>vi ifcfg-ens33
</code></pre>

<p>编辑ifcfg-ens33文件</p>

<p>顺便一提</p>

<p>linux在输入文件名的时候是可以按Tab键自动补全的</p>

<p>如果你玩过minecraft的话会好理解的~</p>

<p><del>比windows高到不知道哪里去了</del></p>

<p>把
<code>ONBOOT=no</code>
改成
<code>ONBOOT=yes</code>
保存退出</p>

<p>重启一下虚拟机</p>

<p>再输入一下ip addr</p>

<p><img src="1587643206328.png" alt="">
现在那个红线上面的ip地址就是你的虚拟机ip地址</p>

<p>现在可以用ssh链接你的虚拟机了~~</p>

<h3>配置基本的环境</h3>

<h4>在自己的电脑上安装git</h4>

<p>由于这个可能不是太复杂就不展开说了</p>

<h4>关防火墙和SELinux</h4>

<p>先要把什么防火墙之类的东西全关掉,防火墙什么的最讨厌了呢~</p>

<p>顺便一提,如果你登录的不是root的话,所有指令最好都带一个sudo前缀,保证你有足够的权限</p>

<p>依次输入
<code>systemctl stop firewalld</code></p>

<pre><code>systemctl disable firewalld
</code></pre>

<p><img src="1587643219610.png" alt="">
这样就把防火墙关掉了~</p>

<p>但是linux还有个叫SELinux的讨厌的东西</p>

<p>编辑/etc/selinux/config文件</p>

<p>再顺便一提,右键powershell就可以粘贴哦~</p>

<p>把对应的一行改成这个
<code>SELINUX=disabled</code>
保存退出</p>

<p>输入
<code>setenforce 0</code></p>

<p>在输入
<code>getenforce</code>
如果显示Disabled就已经关掉了</p>

<p>如果不行就重启一下虚拟机吧~</p>

<h4>安装Apache</h4>

<p>输入
<code>yum -y install httpd</code>
其中它让输yes就输</p>

<p>安装完成后</p>

<p>依次输入
<code>systemctl start httpd</code>
开启http
<code>systemctl enable httpd</code>
设置http开机启动
可以输入
<code>systemctl status httpd</code>
<img src="1587643230779.png" alt="">
如果那个running变成了dead,极大的可能是有东西占用了80端口,比如阿里云就会自带nginx占用掉80端口</p>

<p>这个时候,输入
<code>yum install net-tools</code>
中间可能要输入一次y</p>

<p>完成之后输入
<code>netstat -tlnp|grep 80</code>
<img src="1587643242302.png" alt="">
看到有程序在占用80端口,从右边可以看到进程号为1372,应用是httpd</p>

<p>这个地方由于我已经成功启动了httpd所以显示的是httpd,如果是什么其他的东西,就需要强行把这个应用停止,把80端口让给httpd
<code>kill -9 进程号</code>
直到80端口不再被占用</p>

<p>这时候
<code>systemctl restart httpd</code>
重启一下httpd</p>

<h4>安装Mariadb</h4>

<p>输入
<code>yum -y install mariadb-server.x86_64</code></p>

<p>顺便一提 Mariadb 是类似mysql开源版本的存在</p>

<p>默认的用户名是root</p>

<p>密码是空的</p>

<p>选它主要原因是开源(<del>国内下载的快</del>)</p>

<p>输入
<code>systemctl start mariadb</code>
开启服务</p>

<pre><code>systemctl enable mariadb
</code></pre>

<p>设置开机启动</p>

<pre><code>systemctl status mariadb
</code></pre>

<p>查看状态</p>

<h4>安装php和php-mysql</h4>

<pre><code>yum -y install php php-mysql
</code></pre>

<h4>安装git</h4>

<pre><code>yum install git -y
</code></pre>

<h3>安装Discuz</h3>

<p>我们用git把Discuz的文件下载下来</p>

<p>Discuz的项目地址在</p>

<p><a href="https://gitee.com/ComsenzDiscuz/DiscuzX">https://gitee.com/ComsenzDiscuz/DiscuzX</a></p>

<p>还好不在github...</p>

<p><img src="1587643255695.png" alt="">
一次点击克隆,复制</p>

<p>输入
<code>git clone 你复制到的东西</code></p>

<p>回到主目录,输入
<code>ll</code></p>

<p>就能看到一个叫DiscuzX的文件夹,~~当然你有可能看不出它是文件还是文件夹~~</p>

<p>输入
<code>cp -r DiscuzX/upload /var/www/html/upload</code>
把DiscuzX下的upload文件夹复制到那个奇怪的目录下</p>

<p>那个目录下的东西会被Apache(httpd)给解析成我们熟悉的网页</p>

<p>现在需要给DiscuzX一点权限
依次输入
<code>chmod -Rf 777 /var/www/html/</code></p>

<pre><code>chmod -Rf 777 /var/www/html/upload
</code></pre>

<p>打开浏览器,输入
<code>虚拟机的ip地址/upload</code></p>

<p><img src="1587643265636.png" alt="">
点我同意</p>

<p><img src="1587643271673.png" alt="">
点下一步*2</p>

<p><img src="1587643278921.png" alt="">
数据库密码调成空(如果你没有手动调整数据库密码的话)</p>

<p>记得填写管理员密码哦~</p>

<p>然后就安完了~</p>

<h3>安装wordpress</h3>

<p>先要整到wordpress的安装包</p>

<p>最近的官网不大友好...</p>

<p>而且由于centos7默认的php的版本太低了也不能装版本过高的wordpress</p>

<p>所以我选了wordpress-v5.0.2-zh_CN.zip</p>

<p>现在要用ssh把这个zip传到虚拟机上</p>

<p>我把这个zip放在了e盘</p>

<p>我用了git带的scp</p>

<p>在e盘右键点击git bush here</p>

<p>输入</p>

<pre><code>scp wordpress-v5.0.2-zh_CN.zip root@192.168.0.107:wordpress-v5.0.2-zh_CN.zip
</code></pre>

<p>在powershell输入ll就能看到传上去的文件了</p>

<p>输入
<code>yum install -y unzip zip</code>
安装unzip</p>

<p>输入
<code>unzip wordpress-v5.0.2-zh_CN.zip</code>
解压这个zip包</p>

<p>输入
<code>cp -r wordpress /var/www/html/wordpress</code></p>

<p>在浏览器输入
<code>http://ip地址/wordpress</code>
就能看到wordpress的安装界面了~</p>

<p><img src="1587643288461.png" alt="">
先别急着往下,现在我们要配置一下数据库</p>

<p>回到powershell</p>

<p>依次输入
<code>mysql -uroot</code>
打开数据库
<code>create database wordpress;</code>
建立要用的数据库
<code>GRANT ALL ON wordpress.* TO &#39;wordpressuser&#39;@&#39;%&#39; IDENTIFIED BY &quot;123456&quot;;</code>
建立该数据库的账户,最后一个双引号换成你要的密码</p>

<p>我这里用的123456</p>

<pre><code>quit
</code></pre>

<p>退出数据库</p>

<pre><code>systemctl restart mariadb
</code></pre>

<p>重启一下数据库</p>

<p>回到浏览器</p>

<p><img src="1587643296315.png" alt="">
依次填表</p>

<p>数据库主机填虚拟机的IP地址</p>

<p>如果你用的是阿里云之类的东西记得开放3306端口(数据库使用)</p>

<p>如果出现这个界面</p>

<p><img src="1587643301572.png" alt="">
回到powershell</p>

<p>输入
<code>vi /var/www/html/wordpress/wp-config.php</code>
复制网页里的东西</p>

<p>粘贴(记得右键)</p>

<p>退出保存</p>

<p>然后回浏览器,一直往下走就好了~</p>

<p>之后有空再更新如何把wordpress调成多人模式吧~~</p>

<h3>参考网址</h3>

<p><a href="https://blog.csdn.net/xiehd313/article/details/80814584">https://blog.csdn.net/xiehd313/article/details/80814584</a></p>

<p><a href="https://blog.51cto.com/2382492/2083079">https://blog.51cto.com/2382492/2083079</a></p>

<p><a href="https://www.cnblogs.com/caicaizi/p/9564754.html">https://www.cnblogs.com/caicaizi/p/9564754.html</a></p>

<p><a href="https://blog.csdn.net/sky101010ws/article/details/50782475">https://blog.csdn.net/sky101010ws/article/details/50782475</a></p>

<p><a href="https://blog.csdn.net/weixin_42591732/article/details/102534262">https://blog.csdn.net/weixin_42591732/article/details/102534262</a></p>

<p><a href="https://www.cnblogs.com/biaopei/p/11683407.html">https://www.cnblogs.com/biaopei/p/11683407.html</a></p>

<p><a href="https://blog.csdn.net/weixin_42506905/article/details/90339253">https://blog.csdn.net/weixin_42506905/article/details/90339253</a></p>

<p><a href="https://www.cnblogs.com/lywJ/p/10880332.html">https://www.cnblogs.com/lywJ/p/10880332.html</a></p>

<p><a href="https://www.jianshu.com/p/ad58fd97119e">https://www.jianshu.com/p/ad58fd97119e</a></p>


    </div>

    <!-- The Modal -->
    <div id="myModal" class="modal">

      <!-- The Close Button -->
      <span class="close">&times;</span>

      <!-- Modal Content (The Image) -->
      <div style="display: flex; height: 100%;">
        <img class="modal-content" id="img01">
      </div>

    </div>

    <footer class="footer navbar-fixed-bottom ">
      <div class="container">
        Powered by <a href="https://github.com/kvrmnks/white-blog">White-blog</a>
      </div>
    </footer>

    <script>
      hljs.initHighlightingOnLoad()
    </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.5.0/highlightjs-line-numbers.min.js"></script>
  <script>
      hljs.initHighlightingOnLoad();
      hljs.initLineNumbersOnLoad();
  </script>
  <script src="./../../../../../global.js"></script>
  </body>
</html>